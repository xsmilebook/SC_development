# Progress

- 2026-01-16: 更新 AGENTS.md 规则为中文并调整文档语言要求；建立会话记录与进度文件。
- 2026-01-16: 新增 `docs/README.md`、`docs/workflow.md`、`docs/methods.md`；更新 `README.md` 文档入口与 AGENTS 路径约定。
- 2026-01-16: 根据 `docs/research` 文档补充 `docs/methods.md` 的样本、影像与方法学摘要。
- 2026-01-16: 调整 `ARCHITECTURE.md` 与 `docs/workflow.md` 以匹配当前项目结构与开发需求。
- 2026-01-16: 更新 `AGENTS.md` 约定与 `ARCHITECTURE.md`/`docs/workflow.md` 的数据目录规则（新增 `data/`、`outputs/`）。
- 2026-01-16: 新增 `docs/combat_plan.md`，规划 ComBat/ComBat-GAM 实现与协变量配置。
- 2026-01-16: 更新 `docs/combat_plan.md`：ABCD 协变量修正、合并纵向校正说明与 GAMM 设定对齐。
- 2026-01-16: 更新 `docs/combat_plan.md`：确认沿用既有数据与 GAMM 调用位置一致。
- 2026-01-16: 更新 `docs/combat_plan.md`：ABCD 协变量加入 meanFD，并预留数据路径清单。
- 2026-01-16: 更新 `docs/combat_plan.md`：补齐 HCP-D、ABCD 与 Chinese Cohort 的集群路径。
- 2026-01-16: 更新 `docs/combat_plan.md`：补充 ComBat 使用的 SC 数据与协变量表路径。
- 2026-01-16: 更新 `docs/combat_plan.md`：明确 ABCD 认知方案仅使用基线数据。
- 2026-01-16: 更新 `AGENTS.md`：限制未经指示不得写入项目路径外文件。
- 2026-01-16: 新增 `combat_gam/` 并引入 neuroHarmonize 代码与纵向 ComBat 脚本集合。
- 2026-01-16: 更新 `AGENTS.md`：新增“修改代码或产生新结果需补充文档说明”的流程要求。
- 2026-01-16: 更新 `AGENTS.md`：区分小型任务与正式任务的执行方式（脚本直跑 vs sbatch/q_fat_c）。
- 2026-01-16: 更新 `PLAN.md`：测试直跑，正式任务使用 `sbatch`（`q_fat_c`）。
- 2026-01-17: 新增 ComBat-GAM 实现脚本与 sbatch 模板，完成 HCP-D/Chinese/ABCD 小样本测试。
- 2026-01-18: 建立 `scdevelopment` 环境并通过 rpy2 + mgcv 基函数实现 HCP-D/Chinese ComBat-GAM；更新脚本与文档并重跑小样本测试。
- 2026-01-18: 更新环境使用约定与工作流说明（依赖集中在 `scdevelopment`，冲突时新建环境）。
- 2026-01-18: 新增集群使用说明并移除 sbatch 模板中的 `--time`/`--mem` 设置。
- 2026-01-18: 为 ABCD Nonlinear-ComBat-GAM 增加并行执行支持，并更新集群与流程文档说明。
- 2026-01-18: 删除根目录下未使用的 `neuroCombat.R` 与 `nonlinearlongcombat.R`。
- 2026-01-18: 修复并行版 `nlongcombat` 的 batch 变量作用域错误（sbatch 报错：`Xe` 未定义）。
- 2026-01-18: 为 ABCD 并行提交设置 BLAS 线程限制以避免 OpenBLAS 线程创建失败。
- 2026-01-18: 生成 ABCD Raw vs ComBat 的结构连接 R2 方差分解图。
- 2026-01-18: 按参考图风格重绘 ABCD Raw vs ComBat 方差分解图。
- 2026-01-18: 修复 ComBat 面板柱数异常（edge 名称统一去除 `_h`）。
- 2026-01-18: 修正 Nonlinear-ComBat-GAM 的 batch 回加项（使用全部 batch dummy 列）。
- 2026-01-18: 生成 ABCD 三套协变量方案的 R2 方差分解图。
- 2026-01-18: 生成 HCPD 与 Chinese Cohort 的 Raw vs ComBat R2 方差分解图。
- 2026-01-18: 补充会话小结与关键经验记录。
- 2026-01-18: 合并 CBCL total raw 到 ABCD demopath，新增 CBCL（combat.R）与关联分析脚本，并更新流程与方法文档。
- 2026-01-18: 对齐 CBCL ComBat 脚本结构以匹配 `S3rd_combat_controlsite_ABCD.R`。
- 2026-01-18: 将 `demopath/` 与 `outputs/` 加入忽略清单，并纳入 `docs/` 到版本控制。
- 2026-01-18: CBCL ComBat 脚本加入小样本测试参数并移除 tidyverse 依赖。
- 2026-01-18: CBCL ComBat 脚本改用 `grepl` 以移除 `stringr` 依赖。
