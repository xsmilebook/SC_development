# 会话记录（2026-02-03）

## 目标
- 新增 ABCD cognition（uncorrected）的 LGCM-style slope per year 分析脚本。
- 保持现有数据清洗流程（不做离群点剔除），输出 low/high 预测 slope 的 decile 柱状图。

## 变更
- 新增脚本：`development_script/5th_cognition/run_abcd_lgcm_slope_cognition_uncorrected.R`。
  - 纵向 SC 读取 `*combatgam_age_sex_meanfd.rds`，baseline cognition 读取 `*combatgam_cognition.rds` 并按 `subID` 合并。
  - SC 先做 ratio 缩放（使用 `plotdatasum` 的 `fit`）。
  - 按每个被试最小/最大年龄两次观测计算 `slope_per_year = (SC_t1 - SC_t0) / delta_age`。
  - 线性模型：`slope_per_year ~ age_t0 + SC_t0 + cog_base + sex + site + mean_fd_t0 + mean_fd_t1`。
  - 输出每条边 `beta/t/p` 与 FDR，并生成 low10/high90 预测 slope 的 decile 柱状图（单图 10 组）。

## 文档更新
- `docs/workflow.md`：补充 LGCM-style slope per year 的脚本入口、模型设定与输出说明。
- `PROGRESS.md`：记录本次新增脚本与输出。
- `development_script/5th_cognition/run_abcd_age_lmm_random_slope_cognition_groups.R`：decile 柱状图改用 ggpattern stripe 表示 low 组，图注仅保留 group 并统一样式/位置（High/Low level）。
- `development_script/6th_pfactor/run_abcd_age_lmm_random_slope_pfactor_groups.R`：decile 柱状图同步使用 ggpattern stripe，并统一 group 图注样式/位置。
- mean random slope 的 decile 汇总前剔除 random slope（low/high 均为 0）的连接。
- `development_script/5th_cognition/run_abcd_lgcm_slope_cognition_uncorrected.R`：新增 cog_base beta 矩阵热图（FDR 标注）与 beta–S-A 相关散点图。
- `development_script/6th_pfactor/run_abcd_lgcm_slope_pfactor_general.R`：新增 p-factor LGCM slope 脚本（beta 矩阵热图、beta–S-A 相关散点与 decile 柱状图）。

## 备注
- 本次未提交集群作业；脚本可在本地或集群环境按需运行。
